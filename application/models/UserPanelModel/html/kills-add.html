<div id="form-table-wrapper">
    <form method="POST" action="<?php echo $data->generateInternalHyperlink(UserPanelModel::SUB_KILLS, UserPanelModel::KILLS_ADD . '/' . $data->_guildDetails->_guildId,'', false); ?>" autocomplete="off" enctype="multipart/form-data">
        <table class="form-table standard">
            <thead>
                <tr>
                    <th colspan="2">Encounter Submission</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <th>Guild Name</th>
                    <td>
                        <input id="user-form-guild" name="userpanel-guild" type="hidden" value="<?php echo $data->_guildDetails->_guildId; ?>">
                        <?php echo $data->_guildDetails->_name; ?>
                    </td>
                 </tr>
                <tr>
                    <th>Encounter</th>
                    <td>
                        <select id="user-form-encounter" name="userpanel-encounter">
                            <option value="">Select Encounter</option>
                            <?php foreach( CommonDataContainer::$encounterArray as $encounterId => $encounterDetails): ?>
                                <?php if( !isset($data->_guildDetails->_encounterDetails->$encounterId) ): ?>
                                    <option value="<?php echo $encounterId; ?>"><?php echo $encounterDetails->_dungeon . '-' . $encounterDetails->_encounterName; ?></option>
                                <?php endif; ?>
                            <?php endforeach; ?>
                        </select>
                    </td>
                 </tr>
                <tr>
                    <th>Date (M-D-Y)</th>
                    <td>
                       <select id="user-form-month" name="userpanel-month">
                            <?php foreach( CommonDataContainer::$monthsArray as $month => $monthValue): ?>
                                <?php if ( $month == date('m') ): ?> 
                                    <option value="<?php echo $month; ?>" selected><?php echo $monthValue; ?></option>
                                <?php else: ?>
                                    <option value="<?php echo $month; ?>"><?php echo $monthValue; ?></option>
                                <?php endif; ?>
                            <?php endforeach; ?>
                        </select>
                       <select id="user-form-day" name="userpanel-day">
                            <?php foreach( CommonDataContainer::$daysArray as $day => $dayValue): ?>
                                <?php if ( $day == date('d') ): ?> 
                                    <option value="<?php echo $day; ?>" selected><?php echo $dayValue; ?></option>
                                <?php else: ?>
                                    <option value="<?php echo $day; ?>"><?php echo $dayValue; ?></option>
                                <?php endif; ?>
                            <?php endforeach; ?>
                        </select>  
                       <select id="user-form-year" name="userpanel-year">
                            <?php foreach( CommonDataContainer::$yearsArray as $year => $yearValue): ?>
                                <?php if ( $year == date('Y') ): ?> 
                                    <option value="<?php echo $year; ?>" selected><?php echo $yearValue; ?></option>
                                <?php else: ?>
                                    <option value="<?php echo $year; ?>"><?php echo $yearValue; ?></option>
                                <?php endif; ?>
                            <?php endforeach; ?>
                        </select>
                    </td>
                </tr>
                <tr>
                    <th>Time (H:M UTC)</th>
                    <td>
                       <select id="user-form-hour" name="userpanel-hour">
                            <?php foreach( CommonDataContainer::$hoursArray as $hour => $hourValue): ?>
                                <?php if ( $hour == date('H') ): ?> 
                                    <option value="<?php echo $hour; ?>" selected><?php echo $hourValue; ?></option>
                                <?php else: ?>
                                    <option value="<?php echo $hour; ?>"><?php echo $hourValue; ?></option>
                                <?php endif; ?>
                            <?php endforeach; ?>
                        </select>  
                       <select id="user-form-minute" name="userpanel-minute">
                            <?php foreach( CommonDataContainer::$minutesArray as $minute => $minuteValue): ?>
                                <?php if ( $minute == date('i') ): ?> 
                                    <option value="<?php echo $minute; ?>" selected><?php echo $minuteValue; ?></option>
                                <?php else: ?>
                                    <option value="<?php echo $minute; ?>"><?php echo $minuteValue; ?></option>
                                <?php endif; ?>
                            <?php endforeach; ?>
                        </select>
                    </td>
                </tr>
                <tr>
                    <th>Screenshot</th>
                    <td><input id="user-form-screenshot" type="file" name="userpanel-screenshot"></td>
                </tr>
                <tr>
                    <th>Video Links (Use ";" to separate links)</th>
                    <td><input id="user-form-video" type="text" name="userpanel-video" class="required"></td>
                 </tr>
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="2">
                        <input id="user-form-active" type="hidden" name='active' value="Active">
                        <input id="user-form-submit" type="submit" value="Submit">
                    </td>
                </tr>
            </tfoot>
        </table>
    </form>

    <div id="screenshot-preview"></div>
</div>

<div class="vertical-separator"></div>

<?php if ( $data->_guildDetails->_complete > 0 ): ?>
    <div class="table-wrapper">
        <table class="listing guild">
            <thead>
            </thead>
            <tbody>
                <?php foreach( CommonDataContainer::$dungeonArray as $dungeonId => $dungeonDetails ): ?>
                    <?php echo Template::drawSubTitleTableRow($data->_tableHeader, $dungeonDetails->_name); ?>

                    <?php if ( !empty($data->_guildDetails->_dungeonDetails->$dungeonId->_complete) ): ?>
                        <?php echo Template::drawSubHeaderTableRow($data->_tableHeader); ?>

                        <?php foreach( $data->_guildDetails->_encounterDetails as $encounterId => $encounterDetails ): ?>
                            <?php if( isset($dungeonDetails->_encounters->$encounterId) ): ?>
                                <?php echo Template::drawBodyTableRow($data->_tableHeader, $encounterDetails); ?>
                            <?php endif; ?>
                        <?php endforeach; ?>
                    <?php else: ?>
                        <?php echo Template::drawEmptyGuildTableRow($data->_tableHeader, 'No guild data found.'); ?>
                    <?php endif; ?>
                <?php endforeach; ?>
            </tbody>
        </table>
    </div>
<?php endif; ?>