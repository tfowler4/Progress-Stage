<script>var eventBinder = new UserPanelEventBinder();</script>
<div id="body-wrapper">
    <div id="body-content">
        <div class="vertical-separator"></div>

        <div id="navigation-bar">
            <ul>
                <li><?php echo Functions::generateInternalHyperlink('userpanel', '', '', 'Control Panel Home', ''); ?></li>

                <?php if ( $data->_currentPanel->_action != UserPanelModelGuild::GUILD_ADD && isset($data->_currentPanel->_guildDetails) ): ?>
                    <li>>>></li>
                    <li><?php echo $data->generateInternalHyperlink(UserPanelModelGuild::SUB_GUILD, 
                                                                    $data->_guildDetails->_guildId,
                                                                    'Guild Administration (' . $data->_guildDetails->_name . ')',
                                                                    true); ?></li>
                <?php endif; ?>
                <?php if ( $data->_currentPanel->_action == UserPanelModelGuild::GUILD_EDIT): ?>
                    <li>>>></li>
                    <li>Edit Guild Details</li>
                <?php elseif ( $data->_currentPanel->_action == UserPanelModelGuild::GUILD_ADD ): ?>
                <li>>>></li>
                    <li>Create New Guild</li>
                <?php elseif ( $data->_currentPanel->_action == UserPanelModelGuild::GUILD_REMOVE ): ?>
                    <li>>>></li>
                    <li>Remove Guild</li>
                <?php elseif ( $data->_currentPanel->_action == UserPanelModelGuild::GUILD_RAID_TEAM ): ?>
                    <li>>>></li>
                    <li>Add Raid Team</li>
                <?php endif; ?>
            </ul>
        </div>

        <div class="vertical-separator"></div>

        <div id="main-block">
            <?php if ( !empty($data->_currentPanel->_dialogOptions) ): ?>
                <?php echo Functions::showDialogWindow($data->_currentPanel->_dialogOptions); ?>

                <div class="vertical-separator"></div>
            <?php endif; ?>

            <?php if ( $data->_action == UserPanelModelGuild::GUILD_ADD
                  || $data->_action == UserPanelModelGuild::GUILD_EDIT
                  || $data->_action == UserPanelModelGuild::GUILD_REMOVE
                  || $data->_action == UserPanelModelGuild::GUILD_RAID_TEAM ): ?>
                <?php $data->getHTML($data->_currentPanel); ?>
            <?php else: ?>
                <div class="option-container guild">
                    <div class="option-title">Actions</div>
                    <div id="guild-pane-<?php echo $data->_guildDetails->_guildId; ?>" class="option-header guild"><?php echo $data->_guildDetails->_name; ?></div>
                    <div id="guild-content-<?php echo $data->_guildDetails->_guildId; ?>" class="option-content guild active">
                        <?php echo $data->generateInternalHyperlink(UserPanelModel::SUB_GUILD, UserPanelModelGuild::GUILD_EDIT . '/' . $data->_guildDetails->_guildId,'<div class="option-footer">Edit Guild Details</div>', true); ?>
                        <?php echo $data->generateInternalHyperlink(UserPanelModel::SUB_KILLS, UserPanelModelKill::KILLS_ADD . '/' . $data->_guildDetails->_guildId,'<div class="option-footer">Add/Edit Kill Submissions</div>', true); ?>
                        <?php echo $data->generateInternalHyperlink(UserPanelModel::SUB_GUILD, UserPanelModelGuild::GUILD_RAID_TEAM . '/' . $data->_guildDetails->_guildId,'<div class="option-footer">Add Raid Team</div>', true); ?>
                        <?php echo $data->generateInternalHyperlink(UserPanelModel::SUB_GUILD, UserPanelModelGuild::GUILD_REMOVE . '/' . $data->_guildDetails->_guildId,'<div class="option-footer">Remove Guild</div>', true); ?>
                    </div>

                    <?php foreach( $data->_raidTeams[$data->_guildDetails->_guildId] as $guildId => $guildDetails ): ?>
                        <div id="guild-pane-<?php echo $guildDetails->_guildId; ?>" class="option-footer guild"><?php echo $guildDetails->_name; ?></div>
                        <div id="guild-content-<?php echo $guildDetails->_guildId; ?>" class="option-content guild hidden">
                            <?php echo $data->generateInternalHyperlink(UserPanelModel::SUB_GUILD, UserPanelModelGuild::GUILD_EDIT . '/' . $guildDetails->_guildId,'<div class="option-footer">Edit Raid Team Details</div>', true); ?>
                            <?php echo $data->generateInternalHyperlink(UserPanelModel::SUB_KILLS, UserPanelModelKill::KILLS_ADD . '/' . $guildDetails->_guildId,'<div class="option-footer">Add/Edit Kill Submissions</div>', true); ?>
                            <?php echo $data->generateInternalHyperlink(UserPanelModel::SUB_GUILD, UserPanelModelGuild::GUILD_REMOVE . '/' . $guildDetails->_guildId,'<div class="option-footer">Remove Raid Team</div>', true); ?>
                        </div>
                    <?php endforeach; ?>
                </div>
            <?php endif; ?>
        </div>

        <div id="side-block">
            <?php if ( isset($data->_currentPanel->_guildDetails) ): ?>
                <div id="side-profile-wrapper">
                    <table class="side-profile-table">
                        <thead>
                            <tr>
                                <th colspan="2"><div id="profile-logo"><?php echo $data->_currentPanel->_guildDetails->_logo; ?></div></th>
                            </tr>
                            <tr>
                                <th colspan="2"><div id="profile-name"><?php echo $data->_currentPanel->_guildDetails->_name; ?></div></th>
                            </tr>
                        </thead>
                        <tbody>
                            <?php foreach( UserPanelModelGuild::GUILD_PROFILE as $header => $key ): ?>
                                <tr>
                                    <th><?php echo $header; ?></th>
                                    <td><?php echo $data->_currentPanel->_guildDetails->$key; ?></td>
                                </tr>
                            <?php endforeach; ?>
                        </tbody>
                        <tfoot>
                            <tr>
                                <th colspan="2">
                                    <div id="profile-faction-logo"><?php echo Functions::getImageFaction($data->_currentPanel->_guildDetails->_faction); ?></div>
                                </th>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            <?php else: ?>
                <div id="side-profile-wrapper">
                    <table class="side-profile-table">
                        <thead>
                            <tr>
                                <th colspan="2">
                                    <?php echo $data->_currentPanel->_userDetails->_userName; ?>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th>Email Address</th>
                                <td><?php echo $data->_currentPanel->_userDetails->_emailAddress; ?></td>
                            </tr>
                            <tr>
                                <th>Date Created</th>
                                <td><?php echo Functions::formatDate($data->_currentPanel->_userDetails->_dateCreated, 'm-d-Y'); ?></td>
                            </tr>
                        </tbody>
                        <tfoot>
                        </tfoot>
                    </table>
                </div>
            <?php endif; ?>
        </div>
    </div>
</div>